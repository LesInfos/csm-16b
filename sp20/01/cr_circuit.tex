% Authors: Justin Yu
% Email: justinvyu@berkeley.edu

\qns{CR Circuit}

\meta {
}

We're already familiar with the charging RC circuit from the second problem of this worksheet, 
but what happens if we flip the orientation of the circuit components and switch to discharging?

Consider the circuit below, assume that when $t\leq 0$, the capacitor is fully charged, with $(V_{\text{C}}(t=0) = V_{in})$.
At $t=0$, the switch opens to allow the capacitor to discharge. Assume that $V_{in}=\SI{5}{\volt}$, $R=\SI{100}{\ohm}$, and $C=\SI{10}{\micro\farad}$.

\begin{center}
    \begin{circuitikz}[scale=0.8]
        \draw (-1,4) 
        to [V = $V_{in}$] (-1,0)
        (-1,4) to [opening switch, l_=\mbox{$t = 0$} ] (1,4)
        (1,4) to [C = $C$,i=$i_C(t)$, v = $V_C(t)$] (4,4)
        (4,4) to [short] (6,4)
        to [R = $R$, v = $V_{out}$] (6,0)
        to [short] (-1,0);
    \end{circuitikz}
\end{center}

\begin{enumerate}

\qitem \textbf{Write out the differential equation for the voltage $V_C(t)$ of the capacitor when the switch is open.}

\ws{
\vspace{3em}
}

\meta{}

\sol{
    KCL and Ohm's law at the $V_{out}$ node gives us:
    \begin{align*}
        C \frac{d V_C(t)}{dt} &= \frac{V_{in} - V_C(t)}{R} \\
        \implies \frac{d}{dt} V_C(t) &= - \frac{1}{RC} V_C(t) + \frac{1}{RC} V_{in}
    \end{align*}
}

\qitem \textbf{Solve the differential equation for $V_C(t)$.}

\ws{
\vspace{3em}
}

\sol {
    We begin with a change of variables:
    \begin{align*}
        V_C(t) &= \widetilde{V_C}(t) - \frac{\frac{1}{RC}}{-\frac{1}{RC}} V_{in} \\
               &= \widetilde{V_C}(t) + V_{in}
    \end{align*}

    We plug this new definition of $V_C(t)$ into the original differential equation to remove the constant term.
    \begin{align*}
        \frac{d}{dt} (\widetilde{V_C}(t) + V_{in}) &= - \frac{1}{RC} (\widetilde{V_C}(t) + V_{in}) + \frac{1}{RC} V_{in} \\
        \frac{d}{dt} \widetilde{V_C}(t) &= - \frac{1}{RC} \widetilde{V_C}(t)
    \end{align*}

    Now, we can solve for the new variable $\widetilde{V_C}(t)$:
    \begin{align*}
        \widetilde{V_C}(t) &= Ae^{-\frac{1}{RC} t}
    \end{align*}

    Plug this general solution back into the change of variables definition, then solve using the initial solution: $V_C(0) = 0$.
    \begin{align*}
        V_C(t) &= Ae^{-\frac{1}{RC} t} + V_{in} \\
        \implies V_C(0) = 0 &= Ae^0 + V_{in} \\
        \implies A &= -V_{in}
    \end{align*}
    
    We're now finished, with the final solution:
    \begin{align*}
        V_C(t) &= -V_{in}e^{-\frac{1}{RC} t} + V_{in} \\
               &= V_{in} (1 - e^{-\frac{1}{RC} t})
    \end{align*}
}

\qitem \textbf{What is the steady-state current through the inductor as $t \rightarrow \infty$?} Sketch a plot of the current through the inductor over time, labeling the asymptote after reaching the steady-state.

\ws{
\vspace{3em}
}

\sol {
    \begin{align*}
        \lim_{t \rightarrow \infty} i_L(t) &= \lim_{t \rightarrow \infty} \frac{V_{in}}{R} (1 - e^{-\frac{R}{L}t}) \\
        &= \frac{V_{in}}{R} (1 - 0) \\
        &= \frac{V_{in}}{R}
    \end{align*}

    The physics of the inductor opposes current flow initially, but it approaches the steady-state current as determined by the rest of the circuit (the resistor and voltage source).
}

\qitem \textbf{What is the steady-state voltage drop across the inductor as $t \rightarrow \infty$?}

\ws{
\vspace{3em}
}

\sol {
    \begin{align*}
        \lim_{t \rightarrow \infty} V_L(t) &= \lim_{t \rightarrow \infty} L \frac{d}{dt} i_L(t)  \\
        &= \lim_{t \rightarrow \infty} L (\frac{d}{dt} \frac{V_{in}}{R} (1 - e^{-\frac{R}{L}t})) \\
        &= \lim_{t \rightarrow \infty} L \frac{V_{in}}{R} \frac{R}{L} e^{-\frac{R}{L}t} \\
        &= \lim_{t \rightarrow \infty} V_{in} e^{-\frac{R}{L}t} \\
        &= 0
    \end{align*}
}

\qitem \textbf{What circuit element does the capacitor act like at steady-state ($t \rightarrow \infty$)?}

\sol{
    It acts like an open circuit element. Physically, the charge build up on one side of the plate until
    the replusion of electrons prevents any current flow. In terms of the solved $V_C(t)$, the drop

}

\end{enumerate}
